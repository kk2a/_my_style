\usepackage{amsmath,amsfonts,amssymb,amsthm}
\usepackage{nccmath}
\usepackage{bm}
\usepackage{mathrsfs}
\usepackage{colortbl}
\usepackage{graphics}
\usepackage{hyperref}
\usepackage{tcolorbox}
\usepackage{bookmark}
\usepackage[bottom]{footmisc}
\usepackage{xcolor}
\usepackage{longtable}
\usepackage[toc,title,page]{appendix}
\usepackage{listings,jvlisting}
\usepackage{float}
\usepackage{enumitem}
\usepackage{refcount}
\usepackage{latexsym}
\usepackage{mathtools}

\renewcommand{\appendixname}{\textbf{Appendix} }

\lstset{
  basicstyle={\ttfamily},
  identifierstyle={\small},
  commentstyle={\smallitshape},
  keywordstyle={\small\bfseries},
  ndkeywordstyle={\small},
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},
  lineskip=-0.5ex
}


% 更新したらmktexlsrを実行しよう！！

\theoremstyle{definition}
\newtheorem{thm}{定理}[section]
\newtheorem{lem}[thm]{補題}
\newtheorem{cor}[thm]{系}
\newtheorem{prop}[thm]{命題}
\newtheorem{dfn}[thm]{定義}
\newtheorem{pro}{問題}
\newtheorem{conj}{予想}[section]
\newtheorem*{sol}{解答}
\newtheorem*{com}{コメント}
\newtheorem*{clm}{Claim}
\newtheorem{prt}{Part}

\hypersetup{
  hidelinks,
}

\newcommand{\nn}{\mathbf{N}}
\newcommand{\zz}{\mathbf{Z}}
\newcommand{\qq}{\mathbf{Q}}
\newcommand{\rr}{\mathbf{R}}
\newcommand{\cc}{\mathbf{C}}

\newcommand{\mbf}[1]{\mathbf{#1}}
\newcommand{\mrm}[1]{\mathrm{#1}}
\newcommand{\mcal}[1]{\mathcal{#1}}
\newcommand{\mscr}[1]{\mathscr{#1}}
\newcommand{\mfk}[1]{\mathfrak{#1}}
\newcommand{\tit}[1]{\textit{#1}}
\newcommand{\tbf}[1]{\textbf{#1}}

\newcommand{\flr}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\ceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\paren}[1]{\left( #1 \right)}
\newcommand{\brac}[1]{\left[ #1 \right]}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
\newcommand{\inner}[1]{\left\langle #1 \right\rangle}

\newcommand{\rmone}{I}
\newcommand{\rmtwo}{I\hspace{-1.2pt}I}
\newcommand{\rmthree}{I\hspace{-1.2pt}I\hspace{-1.2pt}I}
\newcommand{\rmfour}{I\hspace{-1.2pt}V}
\newcommand{\rmfive}{V}
\newcommand{\rmsix}{V\hspace{-1.2pt}I}
\newcommand{\rmseven}{V\hspace{-1.2pt}I\hspace{-1.2pt}I}
\newcommand{\rmeight}{V\hspace{-1.2pt}I\hspace{-1.2pt}I\hspace{-1.2pt}I}
\newcommand{\rmnine}{I\hspace{-1.2pt}X}
\newcommand{\rmten}{X}
\newcommand{\niton}{\not \hspace{0.5 pt} \ni}


\usepackage{xparse}

\newcounter{MyAllCounter}
\newcounter{MyAllCounterWithoutDef}

\newcounter{MyTheoremCounter}
\NewDocumentEnvironment{MyTheorem}{O{} O{\theMyTheoremCounter}}{%
  \refstepcounter{MyTheoremCounter}%
  \refstepcounter{MyAllCounter}%
  \refstepcounter{MyAllCounterWithoutDef}%
  \begin{tcolorbox}[colframe=blue,colback=blue!5]
    \begin{thm}[#1]\label{thm:#2}%
  }{%
    \end{thm}\end{tcolorbox}
  }
  
\newcounter{MyLemmaCounter}
\NewDocumentEnvironment{MyLemma}{O{} O{\theMyLemmaCounter}}{%
  \refstepcounter{MyLemmaCounter}%
  \refstepcounter{MyAllCounter}%
  \refstepcounter{MyAllCounterWithoutDef}%
  \begin{tcolorbox}[colframe=red,colback=red!4]
    \begin{lem}[#1]\label{lem:#2}%
  }{%
    \end{lem}\end{tcolorbox}
  }

\newcounter{MyPropositionCounter}
\NewDocumentEnvironment{MyProposition}{O{} O{\theMyPropositionCounter}}{%
  \refstepcounter{MyPropositionCounter}%
  \refstepcounter{MyAllCounter}%
  \refstepcounter{MyAllCounterWithoutDef}%
  \begin{tcolorbox}[colframe=red,colback=red!4]
    \begin{prop}[#1]\label{prop:#2}%
  }{%
    \end{prop}\end{tcolorbox}
  }

\newcounter{MyCorollaryCounter}
\NewDocumentEnvironment{MyCorollary}{O{} O{\theMyCorollaryCounter}}{%
  \refstepcounter{MyCorollaryCounter}%
  \refstepcounter{MyAllCounter}%
  \refstepcounter{MyAllCounterWithoutDef}%
  \begin{tcolorbox}[colframe=red,colback=red!4]
    \begin{cor}[#1]\label{cor:#2}%
  }{%
    \end{cor}\end{tcolorbox}
  }

\newcounter{MyClaimCounter}
\NewDocumentEnvironment{MyClaim}{O{} O{\theMyClaimCounter}}{%
  \refstepcounter{MyClaimCounter}%
  \begin{tcolorbox}[colframe=black,colback=white]
    \begin{clm}[#1]\label{clm:#2}%
  }{%
    \end{clm}\end{tcolorbox}
  }

\newcounter{MyDefinitionCounter}
\NewDocumentEnvironment{MyDefinition}{O{} O{\theMyDefinitionCounter}}{%
  \refstepcounter{MyDefinitionCounter}%
  \refstepcounter{MyAllCounter}%
  \begin{tcolorbox}[colframe=black,colback=white]
    \begin{dfn}[#1]\label{dfn:#2}%
  }{%
    \end{dfn}\end{tcolorbox}
  }
